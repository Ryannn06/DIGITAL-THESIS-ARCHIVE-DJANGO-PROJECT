{% load static %}
{% load hitcount_tags %}

{% if thesis %}
<div class="cardsdisplay">
    <ul class="list-group list-group-flush">
        {% for post in thesis %}
        <li class="list-group-item mb-3">
        <div class="card">
            <div class="card-header p-3">
                <h5>
                    <a class="textmaroon text-decoration-none">{{post.title}}</a>
                    {% if post.published_status == 'Approved' %}
                    <span class="badge bg-success fw-normal ms-1">{{post.published_status}}</span>
                    {% elif post.published_status == 'Pending' %}
                    <span class="badge bg-primary fw-normal ms-1">{{post.published_status}}</span>
                    {% elif post.published_status == 'Rejected' %}
                    <span class="badge bg-danger fw-normal ms-1">{{post.published_status}}</span>
                    {% endif %}
                </h5>

            </div>
            <div class="card-body">
            <div class="content">
                <p class="m-0"><i class="bi bi-person pe-1"></i>By
                    {% for author in post.thesis.all %}
                    <span class="me-1">{{author.first_name}} {{author.last_name}}</span>
                    {% endfor %}
                </p>
                <p class="m-0"><i class="bi bi-person-fill pe-1"></i>Adviser
                    {{post.adviser}}
                </p>
                
                <p class="m-0"><i class="bi bi-building pe-1"></i>{{post.course}}</p>
                <p class="m-0"><i class="bi bi-calendar pe-1"></i>Published in {{post.published_date}}</p>

                {% if post.published_status == 'Approved' %}
                <p class="m-0"><i class="bi bi-eye pe-1"></i>{% get_hit_count for post %} views</p>
                {% endif %}

                <p class="m-0"><i class="bi bi-calendar pe-1"></i>Submitted on {{post.date_created}}</p>
                <div class="tags m-0">
                    <i class="bi bi-tags pe-1"></i>
                    {% for tag in post.tags.all %}
                        <a class="textmaroon">{{tag}}</a>
                    {% endfor %}
                </div>
                <p class="m-0"><i class="bi bi-file-pdf pe-1"></i>
                    <a href="{{post.pdf.url}}" class="text-decoration-none" target="_blank">
                    View PDF
                    </a>
                </p>
            </div>
            <div class="row mt-3">
                {% include 'PersonalAcc/accordionabstract.html' %}
            </div>

            {% if post.published_status == 'Rejected' %}
            <div class="row mt-3">
                <p class="m-0">Reason for rejection: {{post.reason}} </p>
                <a href="{% url 'resubmit' post.slug %}" class="m-0 text-decoration-none">Re-submit?</a>
            </div>
            {% endif %}

            <div class="row mt-3">
                <h5 class="textmaroon">Recommended Citations</h5>
                <p class="text-muted">Generated citations for this thesis project</p>
                <p class="textmaroon mb-0">APA</p>
                <p id="APA">{{post.apa}}</p>

                <p class="textmaroon mb-0">MLA</p>
                <p id="MLA">{{post.mla}}</p>

                <p class="textmaroon mb-0">Chicago</p>
                <p id="Chicago">{{post.chicago}}</p>
            </div>
            </div>
        </div>
        </li>
        {% endfor %}
    </ul>
</div>

{% else %}
    <p>No Papers Found</p>
{% endif %}
